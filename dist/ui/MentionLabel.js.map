{"version":3,"file":"MentionLabel.js","sources":["../../src/ui/MentionLabel/index.tsx"],"sourcesContent":["import './index.scss';\n\nimport React, {\n  ReactElement,\n  useRef,\n  useState,\n  useCallback,\n} from 'react';\nimport type SendBird from 'sendbird';\n\nimport ContextMenu, { MenuItems } from '../ContextMenu';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport UserProfile from '../UserProfile';\nimport useSendbirdStateContext from '../../hooks/useSendbirdStateContext';\n\ninterface MentionLabelProps {\n  mentionTemplate: string;\n  mentionedUserId: string;\n  isByMe: boolean;\n}\n\nexport default function MentionLabel(props: MentionLabelProps): JSX.Element {\n  const {\n    mentionTemplate,\n    mentionedUserId,\n    isByMe,\n  } = props;\n\n  const mentionRef = useRef();\n\n  const sendbirdState = useSendbirdStateContext();\n  const userId = sendbirdState?.config?.userId;\n  const sdk = sendbirdState?.stores?.sdkStore?.sdk;\n  const amIBeingMentioned = userId === mentionedUserId;\n  const [user, setUser] = useState<SendBird.User| null>();\n  const fetchUser = useCallback(\n    (toggleDropdown) => {\n      if (user) {\n        toggleDropdown();\n      }\n      const query = sdk.createApplicationUserListQuery();\n      query.userIdsFilter = [mentionedUserId];\n      query.next((members) => {\n        if (members?.length > 0) {\n          setUser(members[0]);\n        }\n        toggleDropdown();\n      })\n    },\n    [sdk, mentionedUserId],\n  );\n  return (\n    <ContextMenu\n      menuTrigger={(toggleDropdown: () => void): ReactElement => (\n        <a\n          className={`\n            sendbird-word__mention\n            ${amIBeingMentioned ? 'sendbird-word__mention--me' : ''}\n          `}\n          onClick={() => fetchUser(toggleDropdown)}\n          ref={mentionRef}\n        >\n          <Label\n            type={LabelTypography.CAPTION_1}\n            color={isByMe ? LabelColors.ONCONTENT_1 : LabelColors.ONBACKGROUND_1}\n          >\n            {`${mentionTemplate}${mentionedUserId}`}\n          </Label>\n        </a>\n      )}\n      menuItems={(closeDropdown: () => void): ReactElement => (\n        <MenuItems\n          /**\n          * parentRef: For catching location(x, y) of MenuItems\n          * parentContainRef: For toggling more options(menus & reactions)\n          */\n          parentRef={mentionRef}\n          parentContainRef={mentionRef}\n          closeDropdown={closeDropdown}\n          style={{ paddingTop: 0, paddingBottom: 0 }}\n        >\n          <UserProfile disableMessaging user={user} onSuccess={closeDropdown} />\n        </MenuItems>\n      )}\n    />\n  )\n}\n"],"names":["MentionLabel","props","mentionTemplate","mentionedUserId","isByMe","mentionRef","useRef","sendbirdState","useSendbirdStateContext","userId","config","sdk","stores","sdkStore","amIBeingMentioned","_d","useState","user","setUser","fetchUser","useCallback","toggleDropdown","query","createApplicationUserListQuery","userIdsFilter","next","members","length","React","LabelTypography","CAPTION_1","LabelColors","ONCONTENT_1","ONBACKGROUND_1","closeDropdown","paddingTop","paddingBottom","UserProfile"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;SAqBwBA,aAAaC;;;AAEjC,MAAAC,eAAe,GAGbD,KAAK,gBAHP;AAAA,MACAE,eAAe,GAEbF,KAAK,gBAHP;AAAA,MAEAG,MAAM,GACJH,KAAK,OAHP;AAKF,MAAMI,UAAU,GAAGC,MAAM,EAAzB;AAEA,MAAMC,aAAa,GAAGC,uBAAuB,EAA7C;AACA,MAAMC,MAAM,GAAG,MAAAF,aAAa,SAAb,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAEG,MAAf,UAAA,iBAAA,SAAA,MAAuBD,MAAtC;AACA,MAAME,GAAG,GAAG,MAAA,MAAAJ,aAAa,SAAb,IAAAA,aAAa,WAAb,SAAA,GAAAA,aAAa,CAAEK,MAAf,UAAA,iBAAA,SAAA,MAAuBC,QAAvB,UAAA,iBAAA,SAAA,MAAiCF,GAA7C;AACA,MAAMG,iBAAiB,GAAGL,MAAM,KAAKN,eAArC;;AACM,MAAAY,KAAkBC,QAAQ,EAA1B;AAAA,MAACC,IAAI,QAAL;AAAA,MAAOC,OAAO,QAAd;;AACN,MAAMC,SAAS,GAAGC,WAAW,CAC3B,UAACC,cAAD;AACE,QAAIJ,IAAJ,EAAU;AACRI,MAAAA,cAAc;AACf;;AACD,QAAMC,KAAK,GAAGX,GAAG,CAACY,8BAAJ,EAAd;AACAD,IAAAA,KAAK,CAACE,aAAN,GAAsB,CAACrB,eAAD,CAAtB;AACAmB,IAAAA,KAAK,CAACG,IAAN,CAAW,UAACC,OAAD;AACT,UAAI,CAAAA,OAAO,SAAP,IAAAA,OAAO,WAAP,SAAA,GAAAA,OAAO,CAAEC,MAAT,IAAkB,CAAtB,EAAyB;AACvBT,QAAAA,OAAO,CAACQ,OAAO,CAAC,CAAD,CAAR,CAAP;AACD;;AACDL,MAAAA,cAAc;AACf,KALD;AAMD,GAb0B,EAc3B,CAACV,GAAD,EAAMR,eAAN,CAd2B,CAA7B;AAgBA,sBACEyB,6BAAC,WAAD;AACE,IAAA,WAAW,EAAE,qBAACP,cAAD;AAA8C,0BACzDO;AACE,QAAA,SAAS,EAAE,wDAEPd,iBAAiB,GAAG,4BAAH,GAAkC,EAF5C,kBADb;AAKE,QAAA,OAAO,EAAE;AAAM,iBAAAK,SAAS,CAACE,cAAD,CAAT;AAAyB,SAL1C;AAME,QAAA,GAAG,EAAEhB;AANP,sBAQEuB,6BAAC,KAAD;AACE,QAAA,IAAI,EAAEC,eAAe,CAACC,SADxB;AAEE,QAAA,KAAK,EAAE1B,MAAM,GAAG2B,WAAW,CAACC,WAAf,GAA6BD,WAAW,CAACE;AAFxD,SAIG,KAAG/B,eAAH,GAAqBC,eAJxB,CARF,CADyD;AAgB1D,KAjBH;AAkBE,IAAA,SAAS,EAAE,mBAAC+B,aAAD;AAA6C,0BACtDN,6BAAC;AACC;;;;AADF;AAKE,QAAA,SAAS,EAAEvB,UALb;AAME,QAAA,gBAAgB,EAAEA,UANpB;AAOE,QAAA,aAAa,EAAE6B,aAPjB;AAQE,QAAA,KAAK,EAAE;AAAEC,UAAAA,UAAU,EAAE,CAAd;AAAiBC,UAAAA,aAAa,EAAE;AAAhC;AART,sBAUER,6BAACS,oBAAD;AAAa,QAAA,gBAAgB,MAA7B;AAA8B,QAAA,IAAI,EAAEpB,IAApC;AAA0C,QAAA,SAAS,EAAEiB;AAArD,QAVF,CADsD;AAavD;AA/BH,IADF;AAmCD;;;;"}
{"version":3,"file":"QuoteMessage.js","sources":["../../src/ui/QuoteMessage/index.tsx"],"sourcesContent":["import React, { ReactElement, useContext, useState } from 'react';\nimport { FileMessage, UserMessage } from 'sendbird';\nimport './index.scss';\n\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport ImageRenderer from '../ImageRenderer';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  getClassName,\n  getUIKitFileType,\n  getUIKitFileTypes,\n  isFileMessage,\n  isGif,\n  isSupportedFileView,\n  isThumbnailMessage,\n  isUserMessage,\n  isVideo,\n  truncateString,\n} from '../../utils';\ninterface Props {\n  message?: UserMessage | FileMessage;\n  userId?: string;\n  isByMe?: boolean;\n  className?: string | Array<string>;\n  onClick?: () => void;\n}\n\nexport default function QuoteMessage({\n  message,\n  userId = '',\n  isByMe = false,\n  className,\n  onClick,\n}: Props): ReactElement {\n  const { stringSet } = useContext(LocalizationContext);\n\n  const { parentMessage } = message;\n  const parentMessageSender = (parentMessage as UserMessage | FileMessage)?.sender;\n  const parentMessageSenderNickname = (userId === parentMessageSender?.userId) ? stringSet.QUOTED_MESSAGE__CURRENT_USER : parentMessageSender?.nickname;\n  const parentMessageUrl = (parentMessage as FileMessage)?.url || '';\n  const parentMessageType = (parentMessage as FileMessage)?.type;\n  const currentMessageSenderNickname = (userId === message?.sender?.userId) ? stringSet.QUOTED_MESSAGE__CURRENT_USER : message?.sender?.nickname;\n\n  const [isThumbnailLoaded, setThumbnailLoaded] = useState(false);\n  const uikitFileTypes = getUIKitFileTypes();\n  const splitFileName = (parentMessage as FileMessage)?.name ? (parentMessage as FileMessage).name.split('/') : parentMessageUrl.split('/');\n\n  return (\n    <div\n      className={getClassName([className, 'sendbird-quote-message', isByMe ? 'outgoing' : 'incoming'])}\n      key={parentMessage?.messageId}\n      onClick={() => { if (onClick) onClick() }}\n    >\n      <div className=\"sendbird-quote-message__replied-to\">\n        <Icon\n          className=\"sendbird-quote-message__replied-to__icon\"\n          type={IconTypes.REPLY}\n          fillColor={IconColors.ON_BACKGROUND_3}\n          width=\"12px\"\n          height=\"12px\"\n        />\n        <Label\n          className=\"sendbird-quote-message__replied-to__text\"\n          type={LabelTypography.CAPTION_2}\n          color={LabelColors.ONBACKGROUND_3}\n        >\n          {`${currentMessageSenderNickname} ${stringSet.QUOTED_MESSAGE__REPLIED_TO} ${parentMessageSenderNickname}`}\n        </Label>\n      </div>\n      <div className=\"sendbird-quote-message__replied-message\">\n        {/* text message */}\n        {(isUserMessage(parentMessage as UserMessage) && (parentMessage as UserMessage)?.message?.length > 0) && (\n          <div className=\"sendbird-quote-message__replied-message__text-message\">\n            <Label\n              className=\"sendbird-quote-message__replied-message__text-message__word\"\n              type={LabelTypography.BODY_2}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {(parentMessage as UserMessage)?.message}\n            </Label>\n          </div>\n        )}\n        {/* thumbnail message */}\n        {(isThumbnailMessage(parentMessage as FileMessage) && parentMessageUrl) && (\n          <div className=\"sendbird-quote-message__replied-message__thumbnail-message\">\n            <ImageRenderer\n              className=\"sendbird-quote-message__replied-message__thumbnail-message__image\"\n              url={parentMessageUrl}\n              alt={parentMessageType}\n              width=\"144px\"\n              height=\"108px\"\n              onLoad={() => setThumbnailLoaded(true)}\n              defaultComponent={(\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__placeholder\">\n                  <div className=\"sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon\">\n                    <Icon\n                      type={isVideo(parentMessageType) ? IconTypes.PLAY : IconTypes.PHOTO}\n                      fillColor={IconColors.ON_BACKGROUND_2}\n                      width=\"22px\"\n                      height=\"22px\"\n                    />\n                  </div>\n                </div>\n              )}\n            />\n            {(isVideo(parentMessageType) && !((parentMessage as FileMessage)?.thumbnails?.length > 0)) && (\n              <>\n                <video className=\"sendbird-quote-message__replied-message__thumbnail-message__video\">\n                  <source src={parentMessageUrl} type={parentMessageType} />\n                </video>\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover\">\n                  <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover__icon\">\n                    <Icon\n                      type={IconTypes.PLAY}\n                      fillColor={IconColors.GRAY}\n                      width=\"14px\"\n                      height=\"14px\"\n                    />\n                  </div>\n                </div>\n              </>\n            )}\n            {(isThumbnailLoaded && isGif(parentMessageType)) && (\n              <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover\">\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover__icon\">\n                  <Icon\n                    type={IconTypes.GIF}\n                    fillColor={IconColors.GRAY}\n                    width=\"14px\"\n                    height=\"14px\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n        {/* file message */}\n        {(isFileMessage(parentMessage as FileMessage) && !isSupportedFileView((parentMessage as FileMessage).type) && parentMessageUrl) && (\n          <div className=\"sendbird-quote-message__replied-message__file-message\">\n            <Icon\n              className=\"sendbird-quote-message__replied-message__file-message__type-icon\"\n              type={{\n                [uikitFileTypes.IMAGE]: IconTypes.PHOTO,\n                [uikitFileTypes.VIDEO]: IconTypes.PLAY,\n                [uikitFileTypes.AUDIO]: IconTypes.FILE_AUDIO,\n                [uikitFileTypes.GIF]: IconTypes.GIF,\n                [uikitFileTypes.OTHERS]: IconTypes.FILE_DOCUMENT,\n              }[getUIKitFileType(parentMessageType)]}\n              fillColor={IconColors.ON_BACKGROUND_3}\n              width=\"16px\"\n              height=\"16px\"\n            />\n            <Label\n              className=\"sendbird-quote-message__replied-message__file-message__file-name\"\n              type={LabelTypography.BODY_2}\n              color={LabelColors.ONBACKGROUND_3}\n            >\n              {truncateString(splitFileName[splitFileName.length - 1])}\n            </Label>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["QuoteMessage","_a","message","_p","userId","_q","isByMe","className","onClick","stringSet","useContext","LocalizationContext","parentMessage","parentMessageSender","sender","parentMessageSenderNickname","QUOTED_MESSAGE__CURRENT_USER","nickname","parentMessageUrl","url","parentMessageType","type","currentMessageSenderNickname","_r","useState","isThumbnailLoaded","setThumbnailLoaded","uikitFileTypes","getUIKitFileTypes","splitFileName","name","split","React","getClassName","messageId","IconTypes","REPLY","IconColors","ON_BACKGROUND_3","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_3","QUOTED_MESSAGE__REPLIED_TO","isUserMessage","length","BODY_2","ONBACKGROUND_1","isThumbnailMessage","isVideo","PLAY","PHOTO","ON_BACKGROUND_2","thumbnails","GRAY","isGif","GIF","isFileMessage","isSupportedFileView","_b","IMAGE","VIDEO","AUDIO","FILE_AUDIO","OTHERS","FILE_DOCUMENT","getUIKitFileType","truncateString"],"mappings":"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"}
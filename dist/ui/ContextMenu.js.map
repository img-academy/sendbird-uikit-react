{"version":3,"file":"ContextMenu.js","sources":["../../src/ui/ContextMenu/items/MenuItems.jsx","../../src/ui/ContextMenu/items/EmojiListItems.jsx","../../src/ui/ContextMenu/index.jsx"],"sourcesContent":["import React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\n\nexport default class MenuItems extends Component {\n  constructor(props) {\n    super(props);\n    this.menuRef = React.createRef();\n    this.state = {\n      menuStyle: {},\n      handleClickOutside: () => { },\n    };\n  }\n\n  componentDidMount() {\n    this.setupEvents();\n    this.getMenuPosition();\n    this.showParent();\n  }\n\n  componentWillUnmount() {\n    this.cleanUpEvents();\n    this.hideParent();\n  }\n\n  showParent = () => {\n    const { parentContainRef = {} } = this.props;\n    const { current } = parentContainRef;\n    if (parentContainRef && current) {\n      current.classList.add('sendbird-icon--pressed');\n    }\n  }\n\n  hideParent = () => {\n    const { parentContainRef = {} } = this.props;\n    const { current } = parentContainRef;\n    if (parentContainRef && current) {\n      current.classList.remove('sendbird-icon--pressed');\n    }\n  }\n\n  setupEvents = () => {\n    const { closeDropdown } = this.props;\n    const { menuRef } = this;\n    const handleClickOutside = (event) => {\n      if (menuRef.current && !menuRef.current.contains(event.target)) {\n        closeDropdown();\n      }\n    };\n    this.setState({\n      handleClickOutside,\n    });\n\n    document.addEventListener('mousedown', handleClickOutside);\n  }\n\n  cleanUpEvents = () => {\n    const {\n      handleClickOutside,\n    } = this.state;\n    document.removeEventListener('mousedown', handleClickOutside);\n  }\n\n  getMenuPosition = () => {\n    const { parentRef, openLeft } = this.props;\n    const parentRect = parentRef.current.getBoundingClientRect();\n    const x = parentRect.x || parentRect.left;\n    const y = parentRect.y || parentRect.top;\n    const menuStyle = {\n      top: y,\n      left: x,\n    };\n\n    if (!this.menuRef.current) return menuStyle;\n\n    const { innerWidth, innerHeight } = window;\n    const rect = this.menuRef.current.getBoundingClientRect();\n    if (y + rect.height > innerHeight) {\n      menuStyle.top -= rect.height;\n    }\n\n    if (x + rect.width > innerWidth && !openLeft) {\n      menuStyle.left -= rect.width;\n    }\n\n    if (menuStyle.top < 0) {\n      menuStyle.top = rect.height < innerHeight ? (innerHeight - rect.height) / 2 : 0;\n    }\n\n    if (menuStyle.left < 0) {\n      menuStyle.left = rect.width < innerWidth ? (innerWidth - rect.width) / 2 : 0;\n    }\n\n    menuStyle.top += 32;\n    if (openLeft) {\n      const padding = Number.isNaN(rect.width - 30)\n        ? 108 // default\n        : rect.width - 30;\n      menuStyle.left -= padding;\n    }\n\n    return this.setState({ menuStyle });\n  }\n\n  render() {\n    const { menuStyle } = this.state;\n    const { children, style } = this.props;\n    return (\n      createPortal(\n        (\n          <>\n            <div className=\"sendbird-dropdown__menu-backdrop\" />\n            <ul\n              className=\"sendbird-dropdown__menu\"\n              ref={this.menuRef}\n              style={{\n                display: 'inline-block',\n                position: 'fixed',\n                left: `${Math.round(menuStyle.left)}px`,\n                top: `${Math.round(menuStyle.top)}px`,\n                ...style,\n              }}\n            >\n              {children}\n            </ul>\n          </>\n        ),\n        document.getElementById('sendbird-dropdown-portal'),\n      )\n    );\n  }\n}\nMenuItems.propTypes = {\n  closeDropdown: PropTypes.func.isRequired,\n  children: PropTypes.oneOfType([\n    PropTypes.element,\n    PropTypes.arrayOf(PropTypes.element),\n  ]).isRequired,\n  style: PropTypes.shape({}),\n  // https://stackoverflow.com/a/51127130\n  parentRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  parentContainRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  openLeft: PropTypes.bool,\n};\nMenuItems.defaultProps = {\n  style: {},\n  openLeft: false,\n};\n","import React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport PropTypes from 'prop-types';\n\nimport SortByRow from '../../SortByRow';\n\nexport default class EmojiListItems extends Component {\n  constructor(props) {\n    super(props);\n    this.reactionRef = React.createRef();\n    this.state = {\n      reactionStyle: {},\n      handleClickOutside: () => { },\n    };\n  }\n\n  componentDidMount() {\n    this.setupEvents();\n    this.getBarPosition();\n    this.showParent();\n  }\n\n  componentWillUnmount() {\n    this.cleanUpEvents();\n    this.hideParent();\n  }\n\n  showParent = () => {\n    const { parentContainRef = {} } = this.props;\n    const { current } = parentContainRef;\n    if (parentContainRef && current) {\n      current.classList.add('sendbird-reactions--pressed');\n    }\n  }\n\n  hideParent = () => {\n    const { parentContainRef = {} } = this.props;\n    const { current } = parentContainRef;\n    if (parentContainRef && current) {\n      current.classList.remove('sendbird-reactions--pressed');\n    }\n  }\n\n  setupEvents = () => {\n    const { closeDropdown } = this.props;\n    const { reactionRef } = this;\n    const handleClickOutside = (event) => {\n      if (reactionRef.current && !reactionRef.current.contains(event.target)) {\n        closeDropdown();\n      }\n    };\n    this.setState({\n      handleClickOutside,\n    });\n    document.addEventListener('mousedown', handleClickOutside);\n  }\n\n  cleanUpEvents = () => {\n    const {\n      handleClickOutside,\n    } = this.state;\n    document.removeEventListener('mousedown', handleClickOutside);\n  }\n\n  getBarPosition = () => {\n    // calculate the location that the context menu should be\n    const {\n      parentRef,\n      spaceFromTrigger,\n    } = this.props;\n    const spaceFromTriggerX = spaceFromTrigger.x || 0;\n    const spaceFromTriggerY = spaceFromTrigger.y || 0;\n\n    const parentRect = parentRef.current.getBoundingClientRect();\n\n    const x = parentRect.x || parentRect.left;\n    const y = parentRect.y || parentRect.top;\n\n    const reactionStyle = {\n      top: y,\n      left: x,\n    };\n\n    if (!this.reactionRef.current) return reactionStyle;\n    const rect = this.reactionRef.current.getBoundingClientRect();\n\n    if (reactionStyle.top < rect.height) {\n      reactionStyle.top += parentRect.height;\n      reactionStyle.top += spaceFromTriggerY;\n    } else {\n      reactionStyle.top -= rect.height;\n      reactionStyle.top -= spaceFromTriggerY;\n    }\n\n    reactionStyle.left -= (rect.width / 2);\n    reactionStyle.left += (parentRect.height / 2) - 2;\n    reactionStyle.left += spaceFromTriggerX;\n\n    const maximumLeft = (window.innerWidth - rect.width);\n    if (maximumLeft < reactionStyle.left) {\n      reactionStyle.left = maximumLeft;\n    }\n    if (reactionStyle.left < 0) {\n      reactionStyle.left = 0;\n    }\n\n    return this.setState({ reactionStyle });\n  }\n\n  render() {\n    const { reactionStyle } = this.state;\n    const { children } = this.props;\n    return (\n      createPortal(\n        <>\n          <div className=\"sendbird-dropdown__menu-backdrop\" />\n          <ul\n            className=\"sendbird-dropdown__reaction-bar\"\n            ref={this.reactionRef}\n            style={{\n              display: 'inline-block',\n              position: 'fixed',\n              left: `${Math.round(reactionStyle.left)}px`,\n              top: `${Math.round(reactionStyle.top)}px`,\n            }}\n          >\n            <SortByRow\n              className=\"sendbird-dropdown__reaction-bar__row\"\n              maxItemCount={8}\n              itemWidth={44}\n              itemHeight={40}\n            >\n              {children}\n            </SortByRow>\n          </ul>\n        </>,\n        document.getElementById('sendbird-emoji-list-portal'),\n      )\n    );\n  }\n}\nEmojiListItems.propTypes = {\n  closeDropdown: PropTypes.func.isRequired,\n  children: PropTypes.oneOfType([\n    PropTypes.element,\n    PropTypes.arrayOf(PropTypes.element),\n  ]).isRequired,\n  parentRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  parentContainRef: PropTypes.oneOfType([\n    PropTypes.func,\n    PropTypes.shape({ current: PropTypes.instanceOf(Element) }),\n  ]).isRequired,\n  spaceFromTrigger: PropTypes.shape({\n    x: PropTypes.number,\n    y: PropTypes.number,\n  }),\n};\nEmojiListItems.defaultProps = {\n  spaceFromTrigger: {},\n};\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\n\nimport './index.scss';\n\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport { getClassName } from '../../utils';\n\nimport MenuItems_ from './items/MenuItems';\nimport EmojiListItems_ from './items/EmojiListItems';\n\nconst ENTER = 13;\n\nexport const MenuItems = MenuItems_;\nexport const EmojiListItems = EmojiListItems_;\n\nexport const MenuItem = ({\n  className,\n  children,\n  onClick,\n  disable,\n}) => {\n  const handleClickEvent = (e) => { if (!disable) onClick(e); };\n  return (\n    <li\n      className={getClassName([className, 'sendbird-dropdown__menu-item', disable ? 'disable' : ''])}\n      role=\"menuitem\"\n      onClick={handleClickEvent}\n      onKeyPress={(e) => { if (e.keyCode === ENTER) handleClickEvent(e); }}\n      tabIndex={0}\n    >\n      <Label\n        className=\"sendbird-dropdown__menu-item__text\"\n        type={LabelTypography.SUBTITLE_2}\n        color={disable ? LabelColors.ONBACKGROUND_4 : LabelColors.ONBACKGROUND_1}\n      >\n        {children}\n      </Label>\n    </li>\n  );\n};\n\nMenuItem.propTypes = {\n  className: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string),\n  ]),\n  children: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.element,\n  ]).isRequired,\n  onClick: PropTypes.func.isRequired,\n  disable: PropTypes.bool,\n};\n\nMenuItem.defaultProps = {\n  className: '',\n  disable: false,\n};\n\n// Root components should be appended before ContextMenu is rendered\nexport const MenuRoot = () => (\n  <div id=\"sendbird-dropdown-portal\" />\n);\nexport const EmojiReactionListRoot = () => (\n  <div id=\"sendbird-emoji-list-portal\" />\n);\n\nexport default function ContextMenu({ menuTrigger, menuItems }) {\n  const [showMenu, setShowMenu] = useState(false);\n\n  return (\n    <div className=\"sendbird-context-menu\" style={{ display: 'inline' }}>\n      {menuTrigger(() => setShowMenu(!showMenu))}\n      {showMenu && menuItems(() => setShowMenu(false))}\n    </div>\n  );\n}\n\nContextMenu.propTypes = {\n  menuTrigger: PropTypes.func.isRequired,\n  menuItems: PropTypes.func.isRequired,\n};\n"],"names":["MenuItems","props","parentContainRef","current","classList","add","remove","closeDropdown","menuRef","handleClickOutside","event","contains","target","setState","document","addEventListener","state","removeEventListener","parentRef","openLeft","parentRect","getBoundingClientRect","x","left","y","top","menuStyle","window","innerWidth","innerHeight","rect","height","width","padding","Number","isNaN","React","createRef","setupEvents","getMenuPosition","showParent","cleanUpEvents","hideParent","children","style","createPortal","display","position","Math","round","getElementById","Component","propTypes","PropTypes","func","isRequired","oneOfType","element","arrayOf","shape","instanceOf","Element","bool","defaultProps","EmojiListItems","reactionRef","spaceFromTrigger","spaceFromTriggerX","spaceFromTriggerY","reactionStyle","maximumLeft","getBarPosition","number","ENTER","MenuItems_","EmojiListItems_","MenuItem","className","onClick","disable","handleClickEvent","e","getClassName","keyCode","LabelTypography","SUBTITLE_2","LabelColors","ONBACKGROUND_4","ONBACKGROUND_1","string","MenuRoot","EmojiReactionListRoot","ContextMenu","menuTrigger","menuItems","useState","showMenu","setShowMenu"],"mappings":"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"}
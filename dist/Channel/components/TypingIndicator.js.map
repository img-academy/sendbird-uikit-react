{"version":3,"file":"TypingIndicator.js","sources":["../../../src/smart-components/Channel/components/TypingIndicator.tsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport SendBird from 'sendbird';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport { uuidv4 } from '../../../utils/uuid';\nimport Label, { LabelTypography, LabelColors } from '../../../ui/Label';\nimport { useChannel } from '../context/ChannelProvider';\nimport useSendbirdStateContext from '../../../hooks/useSendbirdStateContext';\n\nexport interface TypingIndicatorTextProps {\n  members: SendBird.Member[];\n}\n\nexport const TypingIndicatorText: React.FC<TypingIndicatorTextProps> = ({ members }: TypingIndicatorTextProps) => {\n  const { stringSet } = useContext(LocalizationContext);\n  if (!members || members.length === 0) {\n    return '';\n  }\n\n  if (members && members.length === 1) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__IS_TYPING}`;\n  }\n\n  if (members && members.length === 2) {\n    return `${members[0].nickname} ${stringSet.TYPING_INDICATOR__AND} ${members[1].nickname} ${stringSet.TYPING_INDICATOR__ARE_TYPING}`;\n  }\n\n  return stringSet.TYPING_INDICATOR__MULTIPLE_TYPING;\n};\n\nconst TypingIndicator: React.FC = () => {\n  const { channelUrl } = useChannel();\n  const globalStore = useSendbirdStateContext();\n  const sb = globalStore?.stores?.sdkStore?.sdk;\n  const logger = globalStore?.config?.logger;\n  const [handlerId, setHandlerId] = useState(uuidv4());\n  const [typingMembers, setTypingMembers] = useState<SendBird.Member[]>([]);\n\n  useEffect(() => {\n    if (sb && sb.ChannelHandler) {\n      sb.removeChannelHandler(handlerId);\n      const newHandlerId = uuidv4();\n      const handler = new sb.ChannelHandler();\n      // there is a possible warning in here - setState called after unmount\n      handler.onTypingStatusUpdated = (groupChannel) => {\n        logger.info('Channel > Typing Indicator: onTypingStatusUpdated', groupChannel);\n        if (groupChannel.url === channelUrl) {\n          const members = groupChannel.getTypingMembers();\n          setTypingMembers(members);\n        }\n      };\n      sb.addChannelHandler(newHandlerId, handler);\n      setHandlerId(newHandlerId);\n    }\n\n    return () => {\n      setTypingMembers([]);\n      if (sb && sb.removeChannelHandler) {\n        sb.removeChannelHandler(handlerId);\n      }\n    };\n  }, [channelUrl]);\n\n  return (\n    <Label\n      className=\"sendbird-conversation__footer__typing-indicator__text\"\n      type={LabelTypography.CAPTION_2}\n      color={LabelColors.ONBACKGROUND_2}\n    >\n      <TypingIndicatorText members={typingMembers} />\n    </Label>\n  );\n}\n\nexport default TypingIndicator;\n"],"names":["TypingIndicatorText","_a","members","stringSet","useContext","LocalizationContext","length","nickname","TYPING_INDICATOR__IS_TYPING","TYPING_INDICATOR__AND","TYPING_INDICATOR__ARE_TYPING","TYPING_INDICATOR__MULTIPLE_TYPING","TypingIndicator","channelUrl","useChannel","globalStore","useSendbirdStateContext","sb","stores","sdkStore","sdk","logger","config","_d","useState","uuidv4","handlerId","setHandlerId","_e","typingMembers","setTypingMembers","useEffect","ChannelHandler","removeChannelHandler","newHandlerId","handler","onTypingStatusUpdated","groupChannel","info","url","getTypingMembers","addChannelHandler","React","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_2"],"mappings":"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"}
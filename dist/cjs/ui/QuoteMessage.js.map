{"version":3,"file":"QuoteMessage.js","sources":["../../../src/ui/QuoteMessage/index.tsx"],"sourcesContent":["import React, { ReactElement, useContext, useState } from 'react';\nimport { FileMessage, UserMessage } from 'sendbird';\nimport './index.scss';\n\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport ImageRenderer from '../ImageRenderer';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport {\n  getClassName,\n  getUIKitFileType,\n  getUIKitFileTypes,\n  isFileMessage,\n  isGif,\n  isSupportedFileView,\n  isThumbnailMessage,\n  isUserMessage,\n  isVideo,\n  truncateString,\n} from '../../utils';\ninterface Props {\n  message?: UserMessage | FileMessage;\n  userId?: string;\n  isByMe?: boolean;\n  className?: string | Array<string>;\n  onClick?: () => void;\n}\n\nexport default function QuoteMessage({\n  message,\n  userId = '',\n  isByMe = false,\n  className,\n  onClick,\n}: Props): ReactElement {\n  const { stringSet } = useContext(LocalizationContext);\n\n  const { parentMessage } = message;\n  const parentMessageSender = (parentMessage as UserMessage | FileMessage)?.sender;\n  const parentMessageSenderNickname = (userId === parentMessageSender?.userId) ? stringSet.QUOTED_MESSAGE__CURRENT_USER : parentMessageSender?.nickname;\n  const parentMessageUrl = (parentMessage as FileMessage)?.url || '';\n  const parentMessageType = (parentMessage as FileMessage)?.type;\n  const currentMessageSenderNickname = (userId === message?.sender?.userId) ? stringSet.QUOTED_MESSAGE__CURRENT_USER : message?.sender?.nickname;\n\n  const [isThumbnailLoaded, setThumbnailLoaded] = useState(false);\n  const uikitFileTypes = getUIKitFileTypes();\n  const splitFileName = (parentMessage as FileMessage)?.name ? (parentMessage as FileMessage).name.split('/') : parentMessageUrl.split('/');\n\n  return (\n    <div\n      className={getClassName([className, 'sendbird-quote-message', isByMe ? 'outgoing' : 'incoming'])}\n      key={parentMessage?.messageId}\n      onClick={() => { if (onClick) onClick() }}\n    >\n      <div className=\"sendbird-quote-message__replied-to\">\n        <Icon\n          className=\"sendbird-quote-message__replied-to__icon\"\n          type={IconTypes.REPLY}\n          fillColor={IconColors.ON_BACKGROUND_3}\n          width=\"12px\"\n          height=\"12px\"\n        />\n        <Label\n          className=\"sendbird-quote-message__replied-to__text\"\n          type={LabelTypography.CAPTION_2}\n          color={LabelColors.ONBACKGROUND_3}\n        >\n          {`${currentMessageSenderNickname} ${stringSet.QUOTED_MESSAGE__REPLIED_TO} ${parentMessageSenderNickname}`}\n        </Label>\n      </div>\n      <div className=\"sendbird-quote-message__replied-message\">\n        {/* text message */}\n        {(isUserMessage(parentMessage as UserMessage) && (parentMessage as UserMessage)?.message?.length > 0) && (\n          <div className=\"sendbird-quote-message__replied-message__text-message\">\n            <Label\n              className=\"sendbird-quote-message__replied-message__text-message__word\"\n              type={LabelTypography.BODY_2}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {(parentMessage as UserMessage)?.message}\n            </Label>\n          </div>\n        )}\n        {/* thumbnail message */}\n        {(isThumbnailMessage(parentMessage as FileMessage) && parentMessageUrl) && (\n          <div className=\"sendbird-quote-message__replied-message__thumbnail-message\">\n            <ImageRenderer\n              className=\"sendbird-quote-message__replied-message__thumbnail-message__image\"\n              url={parentMessageUrl}\n              alt={parentMessageType}\n              width=\"144px\"\n              height=\"108px\"\n              onLoad={() => setThumbnailLoaded(true)}\n              defaultComponent={(\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__placeholder\">\n                  <div className=\"sendbird-quote-message__replied-message__thumbnail-message__placeholder__icon\">\n                    <Icon\n                      type={isVideo(parentMessageType) ? IconTypes.PLAY : IconTypes.PHOTO}\n                      fillColor={IconColors.ON_BACKGROUND_2}\n                      width=\"22px\"\n                      height=\"22px\"\n                    />\n                  </div>\n                </div>\n              )}\n            />\n            {(isVideo(parentMessageType) && !((parentMessage as FileMessage)?.thumbnails?.length > 0)) && (\n              <>\n                <video className=\"sendbird-quote-message__replied-message__thumbnail-message__video\">\n                  <source src={parentMessageUrl} type={parentMessageType} />\n                </video>\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover\">\n                  <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover__icon\">\n                    <Icon\n                      type={IconTypes.PLAY}\n                      fillColor={IconColors.GRAY}\n                      width=\"14px\"\n                      height=\"14px\"\n                    />\n                  </div>\n                </div>\n              </>\n            )}\n            {(isThumbnailLoaded && isGif(parentMessageType)) && (\n              <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover\">\n                <div className=\"sendbird-quote-message__replied-message__thumbnail-message__cover__icon\">\n                  <Icon\n                    type={IconTypes.GIF}\n                    fillColor={IconColors.GRAY}\n                    width=\"14px\"\n                    height=\"14px\"\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n        {/* file message */}\n        {(isFileMessage(parentMessage as FileMessage) && !isSupportedFileView((parentMessage as FileMessage).type) && parentMessageUrl) && (\n          <div className=\"sendbird-quote-message__replied-message__file-message\">\n            <Icon\n              className=\"sendbird-quote-message__replied-message__file-message__type-icon\"\n              type={{\n                [uikitFileTypes.IMAGE]: IconTypes.PHOTO,\n                [uikitFileTypes.VIDEO]: IconTypes.PLAY,\n                [uikitFileTypes.AUDIO]: IconTypes.FILE_AUDIO,\n                [uikitFileTypes.GIF]: IconTypes.GIF,\n                [uikitFileTypes.OTHERS]: IconTypes.FILE_DOCUMENT,\n              }[getUIKitFileType(parentMessageType)]}\n              fillColor={IconColors.ON_BACKGROUND_3}\n              width=\"16px\"\n              height=\"16px\"\n            />\n            <Label\n              className=\"sendbird-quote-message__replied-message__file-message__file-name\"\n              type={LabelTypography.BODY_2}\n              color={LabelColors.ONBACKGROUND_3}\n            >\n              {truncateString(splitFileName[splitFileName.length - 1])}\n            </Label>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":["QuoteMessage","_a","message","_p","userId","_q","isByMe","className","onClick","stringSet","useContext","LocalizationContext","parentMessage","parentMessageSender","sender","parentMessageSenderNickname","QUOTED_MESSAGE__CURRENT_USER","nickname","parentMessageUrl","url","parentMessageType","type","currentMessageSenderNickname","_r","useState","isThumbnailLoaded","setThumbnailLoaded","uikitFileTypes","getUIKitFileTypes","splitFileName","name","split","React","getClassName","messageId","Icon","IconTypes","REPLY","IconColors","ON_BACKGROUND_3","Label","LabelTypography","CAPTION_2","LabelColors","ONBACKGROUND_3","QUOTED_MESSAGE__REPLIED_TO","isUserMessage","length","BODY_2","ONBACKGROUND_1","isThumbnailMessage","ImageRenderer","isVideo","PLAY","PHOTO","ON_BACKGROUND_2","thumbnails","GRAY","isGif","GIF","isFileMessage","isSupportedFileView","_b","IMAGE","VIDEO","AUDIO","FILE_AUDIO","OTHERS","FILE_DOCUMENT","getUIKitFileType","truncateString"],"mappings":"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"}